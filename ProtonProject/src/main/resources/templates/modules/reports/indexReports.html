<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<title>Reports Page</title>
	<th:block th:include="addscripts"></th:block>
	<link rel="stylesheet" href="/App/css/modules/reports/reports-page.css">
	<link href="https://fonts.googleapis.com/css2?family=Pathway+Gothic+One&family=Rancho&display=swap"
		rel="stylesheet">
</head>

<body>
	<!-- Include _menu.html -->
	<th:block th:include="_menu"></th:block>
	<div>
		<th:block th:if='${userProtonDetails.hasRole("ROLE_REPORTS_ADMIN") == true}'>
			<button id="admin-edit" class="btn btn-pimary">Reports sources info</button>

			<div id="reportsSourcesInfo">
				<div class="row">

					<div class="col-md-2" id="reportsDatabases">
						<ul class="databases" id="databases"> 

						</ul>
					</div>

					<div class="col-md-10" id="reportsElements">
						<table id="reportsTables" class="table table-bordered">
							<thead>
								<tr>
									<th>Id</th>
									<th>Schema Name</th>
									<th>Table Name</th>
									<th>Create Date</th>
									<th>Update Date</th>
									<th>Is Active</th>
									<th>Alternate Name</th>
									<th>Description</th>
									<th>Config</th>
								</tr>
							</thead>
							<tbody>

							</tbody>
						</table>
					</div>
				</div>
			</div>
			<script>
				var databases = null;
				var tables = null;
				var liDatabases = "";
				var databaseTables = "";
				var existEditColumn = false;
				var relControl = false;
				var relsBootbox;

				window.onload = function () {

					$.ajax({
						url: '/reports/control/getDatabases'
					}).done(function (data) {
						databases = data;
						for (var i in databases) {
							liDatabases += "<li  ><span onclick='getTables(this)' data-id = '" + databases[i].id + "'>" + databases[i].databaseName + "</span><button data-id = '" + databases[i].id + "' class = 'btn' onclick='dbConfig(this)'>info</button><button data-id = '" + databases[i].id + "' class = 'btn' onclick='threadsDb(this)'>threads</button></li>";
						}

						$("#databases").append(liDatabases);
					})

				}

				function threadsDb(node){
					$.ajax({
						url : '/reports/control/threadsFromDatabase',
						data : {
							database : parseInt(node.dataset.id)
						},
						method : 'GET'
					}).done(function(data){
						var message = "";

						message += '<button id = "threadCreate" data-databaseid = "' + node.dataset.id + '"> Add new thread </button><br>';

						if(data.length > 0){
							message += '<table> <thead> <tr> <th> ID </th>'
									+ '<th> Database Id </th>'
									+ '<th> Name </th>'
									+ '<th> Description </th>'
									+ '<th> Is Active </th>'
									+ '<th> Created Date </th>'
									+ '<th> Updated Date </th>'
									+ '</tr> </thead> <tbody>';
							
							for(var i = 0; i < data.length; i++){
								message += '<tr>'
											+ '<td> ' + data[i].id + '</td>'
											+ '<td> ' + data[i].databaseId + '</td>'
											+ '<td> ' + data[i].name + '</td>'
											+ '<td> ' + data[i].description + '</td>'
											+ '<td> ' + data[i].isActive + '</td>' 
											+ '<td> ' + data[i].cDate + '</td>'
											+ '<td> ' + data[i].uDate + '</td>'
										+ '</tr>';
							}

							message += '</tbody> </table>';
										
						}else {
							message += 'No applicable data. Please add some thread for this database';
						}

						bootbox.dialog({
							title : 'Threads',
							message : message,
							size : 'medium'
						})
					})
				}

				function createNewThread(node){

				}

				function getTables(node) {
					$.ajax({
						url: "/reports/control/getTables",
						data: {
							id: node.dataset.id
						}
					}).done(function (data) {
						tables = data;
						var tablesText = "";
						for (var i in tables) {
							tablesText += `<tr data-tableid = "` + tables[i].id + `">
												<td data-editable = "false" data-columnname = "id" data-iddatabase="` + tables[i].idDatabase + `" data-edit = "false" data-type = "number" onclick = "changeTableColumn(this)" data-idcol = "` + ("id" + i) + `tab"> ` + tables[i].id + `</td>
												<td data-columnname = "schema_ame" data-edit = "false" data-type = "string" onclick = "changeTableColumn(this)" data-idcol = "`+ ("schemaName" + i) + `tab"> ` + tables[i].schemaName + `</td>
												<td data-columnname = "table_name" data-edit = "false" data-type = "string" onclick = "changeTableColumn(this)" data-idcol = "`+ ("tableName" + i) + `tab"> ` + tables[i].tableName + `</td>
												<td data-columnname = "c_date" data-edit = "false" data-type = "date" onclick = "changeTableColumn(this)" data-idcol = "`+ ("cDate" + i) + `tab"> ` + tables[i].cDate + `</td>
												<td data-columnname = "u_date" data-edit = "false" data-type = "date" onclick = "changeTableColumn(this)" data-idcol = "`+ ("uDate" + i) + `tab"> ` + tables[i].uDate + `</td>
												<td data-columnname = "isActive" data-edit = "false" data-type = "boolean" onclick = "changeTableColumn(this)" data-idcol = "`+ ("isActive" + i) + `tab"> ` + tables[i].isActive + `</td>
												<td data-columnname = "alt_name" data-edit = "false" data-type = "string" onclick = "changeTableColumn(this)" data-idcol = "`+ ("altName" + i) + `tab"> ` + tables[i].altName + `</td>
												<td data-columnname = "description" data-edit = "false" data-type = "string" onclick = "changeTableColumn(this)" data-idcol = "`+ ("description" + i) + `tab"> ` + tables[i].description + `</td>
												<td> <button data-viewed="false" onclick = "getColumns(this)">Columns</button> <button data-viewed="false" onclick = "getRelations(this, null)">Relations</button> </td>
											</tr>`;
						}
						$('#reportsTables tbody').empty().append(tablesText);
					})
				}

				function getRelations(node, tId) {
					var viewed;

					if(node == null){
						viewed = "false"
						tableId = tId;
					}else{
						tableId = node.parentElement.parentElement.dataset.tableid;
						viewed = node.dataset.viewed;
					}

					if (viewed == "false") {
						$.ajax({
							url: "/reports/control/getRelations",
							data: {
								tableId: tableId
							}
						}).done(function (data) {
							var existRels = data.length == 0 ? false : true;
							var msg = "<div><button id = 'addRel' data-tableId='" + tableId + "' onclick='addRelations(this, null)'>Add relation</button></div>";
							
							if(existRels){
								msg += "<div><table id = 'relatTables' class='table table-bordered'> <thead>"
									+ "<tr><th>ID row <i class='fas fa-lock'></i></th> <th> Id Core Column</th> <th> ColumnName <i class='fas fa-lock'></th> <th>Id Core Table <i class='fas fa-lock'></th>"
									+ "<th>Table Name <i class='fas fa-lock'></th> <th> Id Rel Column </th> <th> Column Name Rel<i class='fas fa-lock'></th> <th>Id Rel Table <i class='fas fa-lock'></th>"
									+ "<th> Table Name Rel <i class='fas fa-lock'></th> <th> Name </th> <th> Description </th> <th> Is Active </th> <th> CreatedDate </th> </tr> </thead>";
								
								msg += '<tbody>'

								for(var i = 0; i < data.length; i++){
									msg += "<tr>"
										+ '<td data-editable = "false">' + data[i].id + '</td>'
										+ '<td data-edit = "false" data-columnname = "id_column_core" data-type = "number" onclick = "changeRelValue(this)" data-idcol = "' + (i.toString() + "idColumnCore") + '">' + data[i].idColumnCore + '</td>'
										+ '<td data-editable = "false">' + data[i].columnName + '</td>'
										+ '<td data-editable = "false">' + data[i].idTable + '</td>'
										+ '<td data-editable = "false">' + data[i].tableName + '</td>'
										+ '<td data-edit = "false" data-columnname = "id_column_sup" data-type = "number" onclick = "changeRelValue(this)" data-idcol = "' + (i.toString() + "idColumnSup") + '">' + data[i].idColumnSup + '</td>'
										+ '<td data-editable = "false">' + data[i].columnNameSup + '</td>'
										+ '<td data-editable = "false">' + data[i].idTableSup + '</td>'
										+ '<td data-editable = "false">' + data[i].tableNameSup + '</td>'
										+ '<td data-edit = "false" data-columnname = "name" data-type = "string" onclick = "changeRelValue(this)" data-idcol = "' + (i.toString() + "name") + '">' + data[i].name + '</td>'
										+ '<td data-edit = "false" data-columnname = "description" data-type = "string" onclick = "changeRelValue(this)" data-idcol = "' + (i.toString() + "description") + '">' + data[i].description + '</td>'
										+ '<td data-edit = "false" data-columnname = "is_active" data-type = "boolean" onclick = "changeRelValue(this)" data-idcol = "' + (i.toString() + "isActive") + '">' + data[i].isActive + '</td>'
										+ '<td data-edit = "false" data-columnname = "c_date" data-type = "date" onclick = "changeRelValue(this)" data-idcol = "' + (i.toString() + "createDate") + '">' + data[i].createDate + '</td>'
										+ '</tr>'
								}
							}else{
								msg += "Not relations yet";
							}

							relsBootbox = bootbox.dialog({
								title : "Relations",
								message : msg,
								size : 'large'
							})

							if(existRels){
								$('div.modal-dialog').css('width', '95%').css('margin', '0 auto').css('margin-top', '20px')
							}
						})
					}
				};

				function addRelations(node, tableIdT){
					relControl = false;
					if(node != null){
						var tableId = node.dataset.tableid;
					}else{
						var tableId = tableIdT;
					}
					$.ajax({
						url: "/reports/control/getColumnsByTable",
						data: {
							id: tableId
						}
					}).done(function (data) {
						var optSel = "<p>Source columns : </p><select id='tableCols' onchange='fillName()'>";
						for(var i = 0; i < data.length; i++){
							optSel += '<option value = "' + data[i].id + '">' + data[i].columnName + '</option>';
						}
						optSel += '</select><br>';

						var tblName;

						var tabSel = '<p>Available tables :</p><select id = "tableSelector" onchange="addRelationsChangeTargetTable()">';

						for(var i = 0; i < tables.length; i++){
							if(tables[i].id != tableId){
								tabSel += '<option value = "' + tables[i].id + '">' + tables[i].schemaName + '.' + tables[i].tableName + '</option>';
							}else{
								tblName =  tables[i].schemaName + '.' + tables[i].tableName;
							}
						}

						tabSel += '</select><br>';

						var selRel = "<p> Available columns : </p><select id = 'selectorRelCol' onchange='fillName()'></select><br>"

						var inptName = '<p> Name of Relation : </p><input id = "relName" style = "width:100%" onchange="relControl = true"><br>';
						var description = '<p> Description for relation :</p><input id = "descriptionRel"><br>'

						var msg = optSel + tabSel + selRel + inptName + description;

						bootbox.confirm({
							title : 'Add new Relation for ' + tblName,
							message : msg,

							buttons : {
								cancel : {
									label : 'Cancel',
									className : 'btn-danger'
								},
								
								confirm : {
									label : 'Accept',
									className : 'btn-success'
								}
							},

							callback : function(result){
								if(result){
									$.ajax({
										method : 'POST',
										url : '/reports/control/createRelation',
										data : {
											idColumn : parseInt($('#tableCols').val()),
											idColumnSup : parseInt($('#selectorRelCol').val()),
											name : $('#relName').val(),
											description : $('#descriptionRel').val(),
											isActive : true
										}
									}).done(function(){
										$.growl.notice({
											title : 'Update succesful!',
											message : 'Relation was be add'
										});

										relsBootbox.modal('hide');
										getRelations(null, tableId)
									}).fail(function(e){
										$.growl.error({
											title: 'Error',
											message: e.responseText,
											duration : 25000
										})
									})
								}
							}
						});

						$('#tableSelector').trigger('change');
						
					});
				}

				function addRelationsChangeTargetTable(){
					var tableId = $('#tableSelector').val();
					$.ajax({
						url: "/reports/control/getColumnsByTable",
						data: {
							id: tableId
						}
					}).done(function (data) {
						$('#selectorRelCol').empty();
						var newSel = "";
						for(var i = 0; i < data.length; i++){
							newSel += '<option value = "' + data[i].id + '">' + data[i].columnName + '</option>';
						}

						$('#selectorRelCol').append(newSel);
					});
				};

				function fillName(){
					if(($('#relName').val() == null || $('#relName').val() == "") || relControl == false){
						$('#relName').val('Relation : ' + $('#tableCols option:selected').text() + '->' + $('#selectorRelCol option:selected').text());
					}
				}

				function changeRelValue(node) {
					var type = node.dataset.type;
					if (node.dataset.edit == "false") {
						if (!existEditColumn) {
							existEditColumn = true;
							if (node.dataset.edit == "false") {
								node.dataset.edit = "true";
								var str = "";
								if (type == "boolean") {
									str = "<select class = 'selectpicker'>"
										+ "<option value = '1' " + (node.innerText == "true" ? 'selected' : '') + ">true</option>"
										+ "<option value = '0' " + (node.innerText == "false" ? 'selected' : '') + ">false</option>"
										+ "</select>";

								} else if (type == "string") {
									str = '<textarea>' + node.innerText + '</textarea>';

								} else if (type == "number") {
									str = '<input type = "number" value = ' + parseInt(node.innerText) + '>'
								} else if (type == "date") {
									str = '<input type = "date" value = "' + node.innerText + '">'
								}

								str += "<p><button class = 'reports-save' onclick='saveRelToDb(this, \"selector\")'><i class='far fa-check-circle'></i></button>"
									+ "<button class = 'reports-cancel' data-val = '" + node.innerText + "' onclick = 'cancelSave(this)'><i class='fas fa-ban'></i></button></p>";
								$("[data-idcol='" + node.dataset.idcol + "']").empty().append(str);
							}
						}
					}
				}

				function saveRelToDb(node, type) {
					console.log(node)
					$.ajax({
						url: "/reports/control/updateRelation",
						method: "POST",
						data: {
							id: parseInt(node.offsetParent.parentElement.children[0].innerText),
							columnName: node.offsetParent.dataset.columnname,
							value: convertVal(node.offsetParent.children[0].value, node.offsetParent.dataset.type)
						}
					}).done(function (data) {
						$.growl.notice({
							title: 'Update succesful!',
							message: data
						});

						var stringAfter = "";

						if (type == 'boolean') {
							switch (node.offsetParent.children[0].value) {
								case 0:
									stringAfter = "false";
									break;
								case 1:
									stringAfter = 'true';
									break;
								default:
									break;
							}
						} else {
							stringAfter = node.offsetParent.children[0].value;
						}

						$(node.offsetParent).empty().append(stringAfter);
						existEditColumn = false;
					}).fail(function (e) {
						$.growl.error({
							title: 'Error',
							message: e.responseText
						})
					});
				}

				function getColumns(node) {

					if (node.dataset.viewed == "false") {
						var tableid = node.parentElement.parentElement.dataset.tableid;
						$.ajax({
							url: "/reports/control/getColumnsByTable",
							data: {
								id: tableid
							}
						}).done(function (data) {

							testCols = data;

							data.sort(function (a, b) {
								return a.id - b.id;
							})

							var tableStr = `<table id = "columnTable" class = "table table-bordered" data-tableid = '` + tableid + `'>
												<thead>
													<tr>
														<th> Id </th>
														<th> Column Name </th>
														<th> Description </th>
														<th> Alternate Name </th>
														<th> Is DictVal </th>
														<th> Is Active </th>
														<th> Create Date </th>
														<th> Update Date </th>
														<th> Is Need Encrypt </th>
													</tr>
												</thead>
												<tbody>`;

							for (var i in data) {
								tableStr += `<tr>
												<td data-editable = "false" data-columnname = "id" data-edit = "false" data-type = "number" onclick = "changeColumnValue(this)" data-idcol = "`+ ("id" + i) + `"> ` + data[i].id + `</td>
												<td data-edit = "false" data-columnname = "column_name" data-type = "string" onclick = "changeColumnValue(this)" data-idcol = "`+ ("columnName" + i) + `"> ` + data[i].columnName + `</td>
												<td data-edit = "false" data-columnname = "description" data-type = "string" onclick = "changeColumnValue(this)" data-idcol = "`+ ("description" + i) + `"> ` + data[i].description + `</td>
												<td data-edit = "false" data-columnname = "alt_name" data-type = "string" onclick = "changeColumnValue(this)" data-idcol = "`+ ("altName" + i) + `"> ` + data[i].altName + `</td>
												<td data-edit = "false" data-columnname = "isDictVal" data-type = "boolean" onclick = "changeColumnValue(this)" data-idcol = "`+ ("isDictVal" + i) + `"> ` + data[i].isDictVal + `</td>
												<td data-edit = "false" data-columnname = "isActive" data-type = "boolean" onclick = "changeColumnValue(this)" data-idcol = "`+ ("isActive" + i) + `"> ` + data[i].isActive + `</td>
												<td data-edit = "false" data-columnname = "c_date" data-type = "date" onclick = "changeColumnValue(this)" data-idcol = "`+ ("cDate" + i) + `"> ` + data[i].cDate + `</td>
												<td data-edit = "false" data-columnname = "u_date" data-type = "date" onclick = "changeColumnValue(this)" data-idcol = "`+ ("uDate" + i) + `"> ` + data[i].uDate + `</td>
												<td data-edit = "false" data-columnname = "is_need_encrypt" data-type = "boolean" onclick = "changeColumnValue(this)" data-idcol = "`+ ("isNeedEncrypt" + i) + `"> ` + data[i].isNeedEncrypt + `</td>
											</tr>`;

							}

							tableStr += "</tbody></table>";

							bootbox.dialog({
								title: "Columns",
								message: tableStr,
								size: 'large'
							})
						})
					}
				}

				function changeColumnValue(node) {
					var type = node.dataset.type;
					console.log(node);
					if (node.dataset.edit == "false") {
						if (!existEditColumn) {
							existEditColumn = true;
							if (node.dataset.edit == "false") {
								node.dataset.edit = "true";
								var str = "";
								if (type == "boolean") {
									str = "<select class = 'selectpicker'>"
										+ "<option value = '1' " + (node.innerText == "true" ? 'selected' : '') + ">true</option>"
										+ "<option value = '0' " + (node.innerText == "false" ? 'selected' : '') + ">false</option>"
										+ "</select>";

								} else if (type == "string") {
									str = '<textarea>' + node.innerText + '</textarea>';

								} else if (type == "number") {
									str = '<input type = "number" value = ' + parseInt(node.innerText) + '>'
								} else if (type == "date") {
									str = '<input type = "date" value = "' + node.innerText + '">'
								}

								str += "<p><button class = 'reports-save' onclick='saveColumnToDb(this, \"selector\")'><i class='far fa-check-circle'></i></button>"
									+ "<button class = 'reports-cancel' data-val = '" + node.innerText + "' onclick = 'cancelSave(this)'><i class='fas fa-ban'></i></button></p>";
								$("[data-idcol='" + node.dataset.idcol + "']").empty().append(str);
							}
						}
					}
				}

				function changeTableColumn(node) {
					var type = node.dataset.type;
					if (node.dataset.edit == "false") {
						if (!existEditColumn) {
							existEditColumn = true;
							if (node.dataset.edit == "false") {
								node.dataset.edit = "true";
								var str = "";
								if (type == "boolean") {
									str = "<select class = 'selectpicker'>"
										+ "<option value = '1' " + (node.innerText == "true" ? 'selected' : '') + ">true</option>"
										+ "<option value = '0' " + (node.innerText == "false" ? 'selected' : '') + ">false</option>"
										+ "</select>";

								} else if (type == "string") {
									str = '<textarea>' + node.innerText + '</textarea>';

								} else if (type == "number") {
									str = '<input type = "number" value = ' + parseInt(node.innerText) + '>'
								} else if (type == "date") {
									str = '<input type = "date" value = "' + node.innerText + '">'
								}

								str += "<p><button class = 'reports-save' onclick='saveTableToDb(this, \"selector\")'><i class='far fa-check-circle'></i></button>"
									+ "<button class = 'reports-cancel' data-val = '" + node.innerText + "' onclick = 'cancelSave(this)'><i class='fas fa-ban'></i></button></p>";
								$("[data-idcol='" + node.dataset.idcol + "']").empty().append(str);
							}
						}
					}

				}

				function cancelSave(node) {
					existEditColumn = false;
					$parent = node.offsetParent;
					node.offsetParent.dataset.edit = "";
					$(node.offsetParent).empty().append(node.dataset.val);
				}

				function saveTableToDb(node, type) {
					$.ajax({
						url: "/reports/control/updateTable",
						method: "POST",
						data: {
							tableId: parseInt(node.offsetParent.parentElement.children[0].innerText),
							databaseId: node.offsetParent.parentElement.children[0].dataset.iddatabase,
							field: node.offsetParent.dataset.columnname,
							value: convertVal(node.offsetParent.children[0].value, node.offsetParent.dataset.type)
						}
					}).done(function (data) {
						$.growl.notice({
							title: 'Update succesful!',
							message: data
						});

						var stringAfter = "";

						if (type == 'boolean') {
							switch (node.offsetParent.children[0].value) {
								case 0:
									stringAfter = "false";
									break;
								case 1:
									stringAfter = 'true';
									break;
								default:
									break;
							}
						} else {
							stringAfter = node.offsetParent.children[0].value;
						}

						$(node.offsetParent).empty().append(stringAfter);
						existEditColumn = false;
					}).fail(function (e) {
						$.growl.error({
							title: 'Error',
							message: e.responseText
						})
					});
				}

				function saveColumnToDb(node, type) {
					$.ajax({
						url: "/reports/control/updateColumn",
						method: "POST",
						data: {
							tableId: parseInt(node.offsetParent.offsetParent.dataset.tableid),
							columnId: parseInt(node.offsetParent.parentElement.children[0].innerText),
							param: node.offsetParent.dataset.columnname,
							columnValue: convertVal(node.offsetParent.children[0].value, node.offsetParent.dataset.type)
						}
					}).done(function (data) {
						$.growl.notice({
							title: 'Update succesful!',
							message: data
						});

						var stringAfter = "";

						if (type == 'boolean') {
							switch (node.offsetParent.children[0].value) {
								case 0:
									stringAfter = "false";
									break;
								case 1:
									stringAfter = 'true';
									break;
								default:
									break;
							}
						} else {
							stringAfter = node.offsetParent.children[0].value;
						}

						$(node.offsetParent).empty().append(stringAfter);
						existEditColumn = false;
					}).fail(function (e) {
						$.growl.error({
							title: 'Error',
							message: e.responseText
						})
					})
				};

				function convertVal(value, type) {
					var rvalue = "";
					if (type == "boolean") {
						rvalue = parseInt(value);
					} else if (type == "string") {
						rvalue = value;
					} else if (type == "number") {
						rvalue = parseInt(value);
					} else if (node.offsetParent.dataset.type == 'date') {
						rvalue = new Date(value);
					}
					return rvalue;
				}

				function dbConfig(node) {
					$.ajax({
						url: '/reports/control/getDatabaseInfo',
						method: "GET",
						data: {
							idDatabase: parseInt(node.dataset.id)
						}
					}).done(function (data) {
						console.log(data);
						var msg = '<table class = "databaseInfo"><tbody>';
						msg += '<tr><td>Name :</td><td><input id = "databaseName" value = "' + data.databaseName + '"></td></tr>';
						msg += '<tr><td>Driver :</td><td><input id = "driveName" value = "' + data.driverName + '"></td></tr>';
						msg += '<tr><td>Url :</td><td><input id="connection" value = "' + data.url + '"></td></tr>'
						msg += '<tr><td>User :</td> <td> <input id="username" value = "' + data.userName + '"></td></tr>'
						msg += '<tr><td>Password :</td> <td> <input id="password" type = "password" value = "' + data.password + '"></td></tr>'
						msg += '<tr><td>Test query :</td> <td> <input id="username" value = "' + data.testSql + '"></td></tr>'
						msg += "</tbody></table>";

						bootbox.dialog({
							title: data.databaseName + " config",
							message: msg
						});
					})
				}
			</script>
		</th:block>
	</div>
	<div>
		<textarea name="Metadata change" id="metaChange">Hello, World!</textarea>
	</div>

	<script th:inline="javascript">
		var testCols;
		var resultMetaData = {
			timeSpend : 0.4,
			recordName : 'employees_information',
			columns : [{
				columnName : 'Identificator',
				code : 'id',
				type : 'integer'
			},{
				columnName : 'Group Name',
				code : 'group_name',
				type : 'String'
			},{
				columnName : 'Head',
				code : 'head_name',
				type : 'integer'
			},{
				columnName : 'Create date',
				code : 'created_date',
				type : 'integer'
			},{
				columnName : 'Employees count',
				code : 'emp_count',
				type : 'integer'
			}]
		};

		var text = "record " + resultMetaData.recordName + "\n";
	</script>
</body>

</html>